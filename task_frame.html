<!-- $Id: task_frame.html,v 1.5 2004/07/19 16:34:31 jz Exp $ -->
<html>

<head>
    <meta name="vs_targetSchema"    content="http://schemas.microsoft.com/intellisense/ie5"/>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>


    <style type="text/css">
        @import "scheduler.css";
    </style>

    <title>Scheduler</title>

</head>

<body>

<!--p>
    <b>
        <span id="job_name"></span>
        &#160;
        <span id="job_title"></span>
    </b>
</p-->

<p>&#160;</p>

<xml id="stylesheet" src="scheduler.xsl"></xml>

<script defer="true" type="text/javascript" src="scheduler.js"></script>

<script type="text/javascript" for="window" event="onload"> do_onload(); </script>

<script defer="true" language="javascript"><!--
//-------------------------------------------------------------------------------------------------

var _stylesheet;
var _timer;
var _job_name;
var _task_id;

//-------------------------------------------------------------------------------------------onload

function do_onload()
{
    _stylesheet = document.all.stylesheet.XMLDocument;
    if( _stylesheet.parseError.errorCode )  throw new Error( "Fehler im Stylesheet:\n" + _stylesheet.parseError.reason );

    document.all.stylesheet.outerHTML = "<span id='stylesheet'></span>";
}

//--------------------------------------------------------------------------------show_task_details

function show_task_details( job_element, task_element )
{
    var job_title = job_element.getAttribute( "title" );
    
    _job_name = job_element.getAttribute( "job" )
    _task_id = task_element.getAttribute( "id" );

    //document.all.job_name.innerText = "Job " + _job_name;
    //document.all.job_title.innerText = job_title? job_title : "";


    document.all.stylesheet.innerHTML = task_element.transformNode( _stylesheet );
}

//---------------------------------------------------------------------------------show_job_details

function show_job_details( job_element )
{
    _job_name = job_element.getAttribute( "job" )
    _task_id  = undefined;

    document.all.stylesheet.innerHTML = job_element.transformNode( _stylesheet );
    update();
}

//-------------------------------------------------------------------------------------------update

function update()
{
    if( _task_id != undefined )
    {
        var response = window.parent.jobs_frame.scheduler.execute( "<show_task id='" + _task_id + "' what='all'/>" );
        
        var task_element = response.selectSingleNode( "spooler/answer/task" );
        document.all.stylesheet.innerHTML = task_element? task_element.transformNode( _stylesheet ) : "";
    }
    else
    if( _job_name != undefined )
    {
        var response = window.parent.jobs_frame.scheduler.execute( "<show_job job='" + _job_name + "' what='all,orders'/>" );
        window.parent.jobs_frame.modify_response( response );
        
        var job_element = response.selectSingleNode( "spooler/answer/job" );
        document.all.stylesheet.innerHTML = job_element? job_element.transformNode( _stylesheet ) : "";
    }
}

//-------------------------------------------------------------------------------------------------
--></script>

</body>

</html>
